<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>C√°lculo Ventana de Cambio ‚Äî Claro Colombia</title>
<style>

:root{--claro:#E30613;--text:#111827;--muted:#6b7280;--card:#fff;--shadow:0 12px 30px rgba(0,0,0,.08);--r:16px}
*{box-sizing:border-box}body{margin:0;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;color:var(--text)}
.logo{width:88px;height:88px;border-radius:50%;background:#fff;display:grid;place-items:center;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.08)}
.logoImg{width:100%;height:100%;object-fit:contain}
.wrap{max-width:900px;margin:0 auto;padding:0 16px}
.card{background:var(--card);border-radius:var(--r);box-shadow:var(--shadow);padding:18px}
.h1{font-size:clamp(22px,3.6vw,30px);font-weight:900;margin:0}
.sub{color:#6b7280;margin-top:6px;font-weight:800;letter-spacing:1px}
.searchArea{display:grid;gap:10px}
.inputWrap{position:relative}
input#q{width:100%;padding:16px 44px 16px 16px;border:1px solid #e5e7eb;border-radius:14px;font-size:18px;outline:none}
input#q:focus{border-color:#ef4444;box-shadow:0 0 0 3px #fecaca}
.icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#ef4444}
.suggestions{margin:0;padding:0;list-style:none;border:1px solid #e5e7eb;border-radius:12px;max-height:260px;overflow:auto;background:#fff}
.suggestions li{padding:10px 12px;border-bottom:1px solid #f3f4f6;cursor:pointer}
.suggestions li:last-child{border-bottom:0}
.suggestions li:hover, .suggestions li.active{background:#fef2f2}
.kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.kpi .tile{border:1px solid #f0f0f0;border-radius:12px;padding:14px}
.kpi .label{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:.6px}
.kpi .value{font-weight:800;font-size:20px;margin-top:6px}
.hint{color:var(--muted);font-size:13px}
.badge{display:inline-block;background:#fef2f2;color:#991b1b;padding:6px 10px;border-radius:999px;font-weight:700}
.fallback{display:grid;place-items:center;width:100%;height:100%;background:var(--claro);color:#fff;font-weight:900;font-size:18px}
header{background:#fff;color:#111;padding:20px 0;border-bottom:3px solid var(--claro)}
.brand{display:flex;align-items:center;gap:14px}
main{padding:22px 0}
footer{color:#6b7280;font-size:13px;margin:24px 0}


</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="brand">
      <div class="logo"><img src="https://commons.wikimedia.org/wiki/Special:FilePath/Claro.svg" alt="Logo Claro" class="logoImg" onerror="useFallbackLogo(this)"/></div>
      <div>
        <h1 class="h1">Calculo ventana de cambio</h1>
        <div class="sub">PORT&TEAM</div>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="card">
    <div class="searchArea">
      <label for="q"><b>Ciudad de destino</b></label>
      <div class="inputWrap">
        <input id="q" type="text" placeholder="Ej: Bogot√°, Medell√≠n, Cali, Granada..." autocomplete="off" />
        <span class="icon">üîé</span>
      </div>
      <ul id="suggest" class="suggestions" style="display:none"></ul>
      <div id="msg" class="hint"></div>
    </div>

    <div id="kpis" class="kpi" style="display:none;margin-top:14px">
      <div class="tile"><div class="label">Departamento</div><div id="kDep" class="value">‚Äî</div></div>
      <div class="tile"><div class="label">Operador log√≠stico</div><div id="kOp" class="value">‚Äî</div></div>
      <div class="tile"><div class="label">Fecha de entrega</div><div id="kEnt" class="value">‚Äî</div></div>
      <div class="tile"><div class="label">Ventana de cambio</div><div id="kVen" class="value">‚Äî</div></div>
    </div>

    <div style="margin-top:10px" class="hint"><span id="stamp" class="badge">‚è±Ô∏è Consulta: ‚Äî</span></div>
  </section>
  <section class="card" style="margin-top:14px">
    <h3 style="margin:0 0 8px 0">Recomendaciones</h3>
    <ul style="margin:0 0 0 18px">
      <li>Confirmar la direcci√≥n capturada y recordar al cliente que recibir√° un SMS o correo electr√≥nico para validarla.</li>
      <li>Antes de solicitar un serial al operador log√≠stico, preguntar al cliente qu√© equipo tiene y validar si soporta tecnolog√≠a E-SIM.</li>
      <li>Realizar seguimiento a todos los pedidos para asegurar una entrega efectiva y mejorar la experiencia del cliente.</li>
    </ul>
  </section>
  <footer>¬© Claro Colombia ‚Äî Uso interno</footer>
</main>

<script>

  function useFallbackLogo(img){ const w = img.closest('.logo'); if(!w) return; const d=document.createElement('div'); d.className='fallback'; d.textContent='Claro'; w.innerHTML=''; w.appendChild(d); }
  const normalize = (s)=> (s? s.toString().normalize('NFD').replace(/[\u0300-\u036f]/g,'').toUpperCase().trim() : '');
  const ymd = (d)=> d.toISOString().slice(0,10);
  const fmt = (d)=> d.toLocaleDateString('es-CO', {year:'numeric', month:'2-digit', day:'2-digit'});
  const nowStamp = ()=>{ const n = new Date(); return fmt(n)+' '+String(n.getHours()).padStart(2,'0')+':'+String(n.getMinutes()).padStart(2,'0'); };
  function toMonday(date){ const d = new Date(date.getFullYear(), date.getMonth(), date.getDate()); const dow = d.getDay(); if (dow===1) return d; const add=(8-dow)%7; d.setDate(d.getDate()+add); return d; }
  function easterSunday(year){ const a=year%19,b=Math.floor(year/100),c=year%100,d=Math.floor(b/4),e=b%4,f=Math.floor((b+8)/25),g=Math.floor((b-f+1)/3),h=(19*a+b-d-g+15)%30,i=Math.floor(c/4),k=c%4,l=(32+2*e+2*i-h-k)%7,m=Math.floor((a+11*h+22*l)/451),month=Math.floor((h+l-7*m+114)/31),day=((h+l-7*m+114)%31)+1;return new Date(year, month-1, day); }
  function colombiaHolidays(year){ const set=new Set(), add=(d)=>set.add(ymd(d)), fixed=(m,day)=>new Date(year,m-1,day); add(fixed(1,1)); add(toMonday(fixed(1,6))); add(toMonday(fixed(3,19))); add(fixed(5,1)); add(toMonday(fixed(6,29))); add(fixed(7,20)); add(fixed(8,7)); add(toMonday(fixed(8,15))); add(toMonday(fixed(10,12))); add(toMonday(fixed(11,1))); add(toMonday(fixed(11,11))); add(fixed(12,8)); add(fixed(12,25)); const eas=easterSunday(year); const jh=new Date(eas); jh.setDate(jh.getDate()-3); add(jh); const vh=new Date(eas); vh.setDate(vh.getDate()-2); add(vh); const asc=new Date(eas); asc.setDate(asc.getDate()+43); add(toMonday(asc)); const corpus=new Date(eas); corpus.setDate(corpus.getDate()+64); add(toMonday(corpus)); const sc=new Date(eas); sc.setDate(sc.getDate()+71); add(toMonday(sc)); return set; }
  function addBusinessDays(startDate, daysToAdd, holidaysSet){ const d=new Date(startDate.getFullYear(), startDate.getMonth(), startDate.getDate()); let added=0; while(added<daysToAdd){ d.setDate(d.getDate()+1); const dow=d.getDay(); if(dow===0||dow===6) continue; if(holidaysSet.has(ymd(d))) continue; added++; } return d; }
  const EMBED_DATA = [{"Ciudad": "Acacias", "Departamento": "Meta", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5324675324675324, "Volumen": 77.0}, {"Ciudad": "Aguachica", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8571428571428571, "Volumen": 203.0}, {"Ciudad": "Agustin Codazzi", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8666666666666667, "Volumen": 90.0}, {"Ciudad": "Andalucia", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8, "Volumen": 20.0}, {"Ciudad": "Andalucia", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.0, "Volumen": 5.0}, {"Ciudad": "Anserma", "Departamento": "Caldas", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.4, "Volumen": 15.0}, {"Ciudad": "Apartado", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.45569620253164556, "Volumen": 79.0}, {"Ciudad": "Apartado", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.21568627450980393, "Volumen": 102.0}, {"Ciudad": "Aracataca", "Departamento": "Magdalena", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5555555555555556, "Volumen": 36.0}, {"Ciudad": "Arauca", "Departamento": "Arauca", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8046875, "Volumen": 128.0}, {"Ciudad": "Arjona", "Departamento": "Bolivar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7922077922077922, "Volumen": 77.0}, {"Ciudad": "Arjona", "Departamento": "Bolivar", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.0, "Volumen": 10.0}, {"Ciudad": "Armenia", "Departamento": "Quindio", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8233387358184765, "Volumen": 617.0}, {"Ciudad": "Baranoa", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8452380952380952, "Volumen": 84.0}, {"Ciudad": "Barbosa", "Departamento": "Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.23333333333333334, "Volumen": 60.0}, {"Ciudad": "Barrancabermeja", "Departamento": "Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7595419847328244, "Volumen": 262.0}, {"Ciudad": "Barranquilla", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8147946695675823, "Volumen": 3677.0}, {"Ciudad": "Barranquilla", "Departamento": "Atlantico", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6821561338289963, "Volumen": 538.0}, {"Ciudad": "Bello", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7754491017964071, "Volumen": 668.0}, {"Ciudad": "Bello", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6885964912280702, "Volumen": 228.0}, {"Ciudad": "Bogota", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8677489505891873, "Volumen": 19773.0}, {"Ciudad": "Bogota", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7453596287703016, "Volumen": 5172.0}, {"Ciudad": "Bojaca", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5454545454545454, "Volumen": 11.0}, {"Ciudad": "Bojaca", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5106382978723404, "Volumen": 47.0}, {"Ciudad": "Bosconia", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7096774193548387, "Volumen": 62.0}, {"Ciudad": "Bucaramanga", "Departamento": "Santander", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9068493150684932, "Volumen": 365.0}, {"Ciudad": "Bucaramanga", "Departamento": "Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9346938775510204, "Volumen": 490.0}, {"Ciudad": "Bucaramanga", "Departamento": "Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7383458646616541, "Volumen": 665.0}, {"Ciudad": "Buenaventura", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.83984375, "Volumen": 256.0}, {"Ciudad": "Buenaventura", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.40476190476190477, "Volumen": 84.0}, {"Ciudad": "Bugalagrande", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.631578947368421, "Volumen": 19.0}, {"Ciudad": "Bugalagrande", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.07692307692307693, "Volumen": 13.0}, {"Ciudad": "Caicedonia", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7857142857142857, "Volumen": 28.0}, {"Ciudad": "Caicedonia", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Cajica", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9069767441860465, "Volumen": 215.0}, {"Ciudad": "Cajica", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.5833333333333334, "Volumen": 96.0}, {"Ciudad": "Calarca", "Departamento": "Quindio", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7045454545454546, "Volumen": 88.0}, {"Ciudad": "Cali", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8916462775253408, "Volumen": 5722.0}, {"Ciudad": "Cali", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8547445255474453, "Volumen": 1370.0}, {"Ciudad": "Candelaria", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8454545454545455, "Volumen": 110.0}, {"Ciudad": "Candelaria", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.4418604651162791, "Volumen": 43.0}, {"Ciudad": "Carepa", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.4230769230769231, "Volumen": 26.0}, {"Ciudad": "Carepa", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.23076923076923078, "Volumen": 26.0}, {"Ciudad": "Carmen de Bolivar", "Departamento": "Bolivar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.4166666666666667, "Volumen": 72.0}, {"Ciudad": "CARTAGENA DE INDIAS", "Departamento": "Bolivar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8181818181818182, "Volumen": 1562.0}, {"Ciudad": "CARTAGENA DE INDIAS", "Departamento": "Bolivar", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.4649122807017544, "Volumen": 228.0}, {"Ciudad": "Cartago", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7989690721649485, "Volumen": 194.0}, {"Ciudad": "Cartago", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6266666666666667, "Volumen": 75.0}, {"Ciudad": "Caucasia", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.65, "Volumen": 60.0}, {"Ciudad": "Caucasia", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Cerete", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9111111111111111, "Volumen": 90.0}, {"Ciudad": "Chia", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8730650154798761, "Volumen": 323.0}, {"Ciudad": "Chia", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6717557251908397, "Volumen": 131.0}, {"Ciudad": "Chigorodo", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.4423076923076923, "Volumen": 52.0}, {"Ciudad": "Chigorodo", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.4642857142857143, "Volumen": 28.0}, {"Ciudad": "Chinchina", "Departamento": "Caldas", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9591836734693877, "Volumen": 49.0}, {"Ciudad": "Chinchina", "Departamento": "Caldas", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.0, "Volumen": 2.0}, {"Ciudad": "Chinu", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.9767441860465116, "Volumen": 43.0}, {"Ciudad": "Chiquinquira", "Departamento": "Boyaca", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9296875, "Volumen": 128.0}, {"Ciudad": "Chiriguana", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.5238095238095238, "Volumen": 42.0}, {"Ciudad": "Choconta", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8235294117647058, "Volumen": 17.0}, {"Ciudad": "Cienaga", "Departamento": "Magdalena", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7272727272727273, "Volumen": 110.0}, {"Ciudad": "Cienaga de Oro", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6, "Volumen": 35.0}, {"Ciudad": "Circasia", "Departamento": "Quindio", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.5357142857142857, "Volumen": 28.0}, {"Ciudad": "Copacabana", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8876404494382022, "Volumen": 89.0}, {"Ciudad": "Copacabana", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.5806451612903226, "Volumen": 31.0}, {"Ciudad": "Corozal", "Departamento": "Sucre", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8090909090909091, "Volumen": 110.0}, {"Ciudad": "Cota", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8695652173913043, "Volumen": 46.0}, {"Ciudad": "Cota", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.71875, "Volumen": 32.0}, {"Ciudad": "Cucuta", "Departamento": "Norte de Santander", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7792642140468228, "Volumen": 299.0}, {"Ciudad": "Cucuta", "Departamento": "Norte de Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9644549763033176, "Volumen": 422.0}, {"Ciudad": "Cucuta", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7692307692307693, "Volumen": 624.0}, {"Ciudad": "Cumaral", "Departamento": "Meta", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6923076923076923, "Volumen": 78.0}, {"Ciudad": "Curumani", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6363636363636364, "Volumen": 33.0}, {"Ciudad": "Dagua", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6363636363636364, "Volumen": 11.0}, {"Ciudad": "Dosquebradas", "Departamento": "Risaralda", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9658703071672355, "Volumen": 293.0}, {"Ciudad": "Dosquebradas", "Departamento": "Risaralda", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8944099378881988, "Volumen": 161.0}, {"Ciudad": "Duitama", "Departamento": "Boyaca", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.923728813559322, "Volumen": 236.0}, {"Ciudad": "Duitama", "Departamento": "Boyaca", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7126436781609196, "Volumen": 87.0}, {"Ciudad": "El Banco", "Departamento": "Magdalena", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.9019607843137255, "Volumen": 51.0}, {"Ciudad": "El Carmen de Viboral", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8387096774193549, "Volumen": 31.0}, {"Ciudad": "El Carmen de Viboral", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8, "Volumen": 20.0}, {"Ciudad": "El Cerrito", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.88, "Volumen": 75.0}, {"Ciudad": "El Cerrito", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7692307692307693, "Volumen": 26.0}, {"Ciudad": "El Copey", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.625, "Volumen": 24.0}, {"Ciudad": "El Rosal", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8181818181818182, "Volumen": 44.0}, {"Ciudad": "El Rosal", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6428571428571429, "Volumen": 14.0}, {"Ciudad": "El Santuario", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6521739130434783, "Volumen": 23.0}, {"Ciudad": "El Santuario", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5555555555555556, "Volumen": 9.0}, {"Ciudad": "Envigado", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8951048951048951, "Volumen": 286.0}, {"Ciudad": "Envigado", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6865671641791045, "Volumen": 134.0}, {"Ciudad": "Espinal", "Departamento": "Tolima", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6341463414634146, "Volumen": 82.0}, {"Ciudad": "Espinal", "Departamento": "Tolima", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Facatativa", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8207547169811321, "Volumen": 212.0}, {"Ciudad": "Facatativa", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7439024390243902, "Volumen": 82.0}, {"Ciudad": "Florida", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6842105263157895, "Volumen": 57.0}, {"Ciudad": "Florida", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6764705882352942, "Volumen": 34.0}, {"Ciudad": "Floridablanca", "Departamento": "Santander", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.903448275862069, "Volumen": 145.0}, {"Ciudad": "Floridablanca", "Departamento": "Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9107142857142857, "Volumen": 168.0}, {"Ciudad": "Floridablanca", "Departamento": "Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8238341968911918, "Volumen": 193.0}, {"Ciudad": "Floridablanca", "Departamento": "Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8238341968911918, "Volumen": 193.0}, {"Ciudad": "Fonseca", "Departamento": "Guajira", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6836734693877551, "Volumen": 98.0}, {"Ciudad": "Fundacion", "Departamento": "Magdalena", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7272727272727273, "Volumen": 77.0}, {"Ciudad": "Funza", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9301310043668122, "Volumen": 229.0}, {"Ciudad": "Funza", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8, "Volumen": 60.0}, {"Ciudad": "Fusagasuga", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9209302325581395, "Volumen": 215.0}, {"Ciudad": "Fusagasuga", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7333333333333333, "Volumen": 105.0}, {"Ciudad": "Gachancipa", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8846153846153846, "Volumen": 26.0}, {"Ciudad": "Galapa", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8703703703703703, "Volumen": 108.0}, {"Ciudad": "Ginebra", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8695652173913043, "Volumen": 23.0}, {"Ciudad": "Ginebra", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7777777777777778, "Volumen": 9.0}, {"Ciudad": "Girardot", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9279279279279279, "Volumen": 111.0}, {"Ciudad": "Girardot", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.52, "Volumen": 75.0}, {"Ciudad": "Girardota", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7692307692307693, "Volumen": 39.0}, {"Ciudad": "Girardota", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6551724137931034, "Volumen": 29.0}, {"Ciudad": "Giron", "Departamento": "Santander", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8888888888888888, "Volumen": 45.0}, {"Ciudad": "Giron", "Departamento": "Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8113207547169812, "Volumen": 106.0}, {"Ciudad": "Giron", "Departamento": "Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8073394495412844, "Volumen": 109.0}, {"Ciudad": "Giron", "Departamento": "Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8073394495412844, "Volumen": 109.0}, {"Ciudad": "Granada", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6666666666666666, "Volumen": 6.0}, {"Ciudad": "Granada", "Departamento": "Meta", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6666666666666666, "Volumen": 51.0}, {"Ciudad": "Guacari", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7222222222222222, "Volumen": 36.0}, {"Ciudad": "Guacari", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8571428571428571, "Volumen": 14.0}, {"Ciudad": "GUADALAJARA DE BUGA", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "GUADALAJARA DE BUGA", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Guaduas", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.875, "Volumen": 24.0}, {"Ciudad": "Guarne", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9259259259259259, "Volumen": 27.0}, {"Ciudad": "Guarne", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.75, "Volumen": 12.0}, {"Ciudad": "Guasca", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 1.0, "Volumen": 16.0}, {"Ciudad": "Ibague", "Departamento": "Tolima", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Ibague", "Departamento": "Tolima", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7494845360824742, "Volumen": 970.0}, {"Ciudad": "Ibague", "Departamento": "Tolima", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7494845360824742, "Volumen": 970.0}, {"Ciudad": "Ipiales", "Departamento": "Nari√±o", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.9036144578313253, "Volumen": 83.0}, {"Ciudad": "Ipiales", "Departamento": "Nari√±o", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9117647058823529, "Volumen": 102.0}, {"Ciudad": "Itagui", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8871331828442438, "Volumen": 443.0}, {"Ciudad": "Itagui", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6390532544378699, "Volumen": 169.0}, {"Ciudad": "Jamundi", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8745644599303136, "Volumen": 287.0}, {"Ciudad": "Jamundi", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8031496062992126, "Volumen": 127.0}, {"Ciudad": "La Calera", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8409090909090909, "Volumen": 44.0}, {"Ciudad": "La Ceja", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8596491228070176, "Volumen": 57.0}, {"Ciudad": "La Ceja", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.675, "Volumen": 40.0}, {"Ciudad": "La Dorada", "Departamento": "Caldas", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.9375, "Volumen": 64.0}, {"Ciudad": "La Dorada", "Departamento": "Caldas", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.625, "Volumen": 32.0}, {"Ciudad": "La Estrella", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9431818181818182, "Volumen": 88.0}, {"Ciudad": "La Estrella", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.5333333333333333, "Volumen": 45.0}, {"Ciudad": "La Jagua de Ibirico", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.71875, "Volumen": 32.0}, {"Ciudad": "La Mesa", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6976744186046512, "Volumen": 43.0}, {"Ciudad": "La Paz", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7142857142857143, "Volumen": 42.0}, {"Ciudad": "La Tebaida", "Departamento": "Quindio", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8571428571428571, "Volumen": 28.0}, {"Ciudad": "La Union", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.23529411764705882, "Volumen": 17.0}, {"Ciudad": "La Union", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.0, "Volumen": 1.0}, {"Ciudad": "La Virginia", "Departamento": "Risaralda", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 1.0, "Volumen": 32.0}, {"Ciudad": "La Virginia", "Departamento": "Risaralda", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7, "Volumen": 20.0}, {"Ciudad": "Lorica", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8636363636363636, "Volumen": 88.0}, {"Ciudad": "Los Patios", "Departamento": "Norte de Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9069767441860465, "Volumen": 43.0}, {"Ciudad": "Los Patios", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7142857142857143, "Volumen": 35.0}, {"Ciudad": "Los Patios", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7142857142857143, "Volumen": 35.0}, {"Ciudad": "Madrid", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8913043478260869, "Volumen": 368.0}, {"Ciudad": "Madrid", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.765625, "Volumen": 128.0}, {"Ciudad": "Magangue", "Departamento": "Bolivar", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7045454545454546, "Volumen": 88.0}, {"Ciudad": "Maicao", "Departamento": "Guajira", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7942238267148014, "Volumen": 277.0}, {"Ciudad": "Malambo", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8669527896995708, "Volumen": 233.0}, {"Ciudad": "Manizales", "Departamento": "Caldas", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.950517836593786, "Volumen": 869.0}, {"Ciudad": "Manizales", "Departamento": "Caldas", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8235294117647058, "Volumen": 306.0}, {"Ciudad": "Marinilla", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7368421052631579, "Volumen": 38.0}, {"Ciudad": "Marinilla", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.76, "Volumen": 25.0}, {"Ciudad": "Medellin", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7884242592079757, "Volumen": 3611.0}, {"Ciudad": "Medellin", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.655316191799861, "Volumen": 1439.0}, {"Ciudad": "Mompos", "Departamento": "Bolivar", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5789473684210527, "Volumen": 19.0}, {"Ciudad": "Montelibano", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7045454545454546, "Volumen": 88.0}, {"Ciudad": "Montenegro", "Departamento": "Quindio", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7272727272727273, "Volumen": 22.0}, {"Ciudad": "Monteria", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.925, "Volumen": 1000.0}, {"Ciudad": "Mosquera", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9156976744186046, "Volumen": 344.0}, {"Ciudad": "Mosquera", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8770491803278688, "Volumen": 122.0}, {"Ciudad": "Neiva", "Departamento": "Huila", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Neiva", "Departamento": "Huila", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8979591836734694, "Volumen": 588.0}, {"Ciudad": "Oca√±a", "Departamento": "Norte de Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.864406779661017, "Volumen": 59.0}, {"Ciudad": "Oca√±a", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.3018867924528302, "Volumen": 53.0}, {"Ciudad": "Oca√±a", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.3018867924528302, "Volumen": 53.0}, {"Ciudad": "Paipa", "Departamento": "Boyaca", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8793103448275862, "Volumen": 58.0}, {"Ciudad": "Palermo", "Departamento": "Huila", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.72, "Volumen": 25.0}, {"Ciudad": "Palmar de Varela", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.9230769230769231, "Volumen": 39.0}, {"Ciudad": "Palmira", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8672699849170438, "Volumen": 663.0}, {"Ciudad": "Palmira", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8522167487684729, "Volumen": 203.0}, {"Ciudad": "Pamplona", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5533980582524272, "Volumen": 103.0}, {"Ciudad": "Pamplona", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5533980582524272, "Volumen": 103.0}, {"Ciudad": "Pasto", "Departamento": "Nari√±o", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8522920203735145, "Volumen": 589.0}, {"Ciudad": "Pasto", "Departamento": "Nari√±o", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8191489361702128, "Volumen": 282.0}, {"Ciudad": "Pereira", "Departamento": "Risaralda", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9523121387283237, "Volumen": 692.0}, {"Ciudad": "Pereira", "Departamento": "Risaralda", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8449074074074074, "Volumen": 432.0}, {"Ciudad": "Piedecuesta", "Departamento": "Santander", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9242424242424242, "Volumen": 66.0}, {"Ciudad": "Piedecuesta", "Departamento": "Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8125, "Volumen": 80.0}, {"Ciudad": "Piedecuesta", "Departamento": "Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6581196581196581, "Volumen": 117.0}, {"Ciudad": "Piedecuesta", "Departamento": "Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6581196581196581, "Volumen": 117.0}, {"Ciudad": "Planeta Rica", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.9661016949152542, "Volumen": 59.0}, {"Ciudad": "Plato", "Departamento": "Magdalena", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6727272727272727, "Volumen": 55.0}, {"Ciudad": "Polonuevo", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6875, "Volumen": 16.0}, {"Ciudad": "Popayan", "Departamento": "Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6862745098039216, "Volumen": 459.0}, {"Ciudad": "Pradera", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7090909090909091, "Volumen": 55.0}, {"Ciudad": "Pradera", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7916666666666666, "Volumen": 24.0}, {"Ciudad": "Puerto Berrio", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.0, "Volumen": 10.0}, {"Ciudad": "Puerto Berrio", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.0, "Volumen": 8.0}, {"Ciudad": "Puerto Colombia", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.9339622641509434, "Volumen": 106.0}, {"Ciudad": "Puerto Lopez", "Departamento": "Meta", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.47368421052631576, "Volumen": 19.0}, {"Ciudad": "Quimbaya", "Departamento": "Quindio", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6206896551724138, "Volumen": 29.0}, {"Ciudad": "Restrepo", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.5238095238095238, "Volumen": 21.0}, {"Ciudad": "Restrepo", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "RICAURTE", "Departamento": "CUNDINAMARCA", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 1.0, "Volumen": 8.0}, {"Ciudad": "Riohacha", "Departamento": "Guajira", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8908045977011494, "Volumen": 348.0}, {"Ciudad": "Rionegro", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8027210884353742, "Volumen": 147.0}, {"Ciudad": "Rionegro", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6428571428571429, "Volumen": 56.0}, {"Ciudad": "Roldanillo", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7441860465116279, "Volumen": 43.0}, {"Ciudad": "Roldanillo", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7142857142857143, "Volumen": 21.0}, {"Ciudad": "SABANA DE TORRES", "Departamento": "SANTANDER", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.38095238095238093, "Volumen": 21.0}, {"Ciudad": "Sabanagrande", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.5802469135802469, "Volumen": 81.0}, {"Ciudad": "Sabanalarga", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.0, "Volumen": 5.0}, {"Ciudad": "Sabaneta", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9081081081081082, "Volumen": 185.0}, {"Ciudad": "Sabaneta", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7721518987341772, "Volumen": 79.0}, {"Ciudad": "Sahagun", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8723404255319149, "Volumen": 47.0}, {"Ciudad": "Sampues", "Departamento": "Sucre", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.5454545454545454, "Volumen": 44.0}, {"Ciudad": "SAMPUES", "Departamento": "SUCRE", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.5454545454545454, "Volumen": 44.0}, {"Ciudad": "San Gil", "Departamento": "Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5982142857142857, "Volumen": 112.0}, {"Ciudad": "San Juan del Cesar", "Departamento": "Guajira", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6888888888888889, "Volumen": 45.0}, {"Ciudad": "San Juan Nepomuceno", "Departamento": "Bolivar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7608695652173914, "Volumen": 46.0}, {"Ciudad": "San Juan Nepomuceno", "Departamento": "Bolivar", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.0, "Volumen": 12.0}, {"Ciudad": "San Marcos", "Departamento": "Sucre", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.0, "Volumen": 56.0}, {"Ciudad": "San Martin", "Departamento": "Meta", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.17647058823529413, "Volumen": 17.0}, {"Ciudad": "Santa Marta", "Departamento": "Magdalena", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.883289124668435, "Volumen": 1131.0}, {"Ciudad": "Santa Rosa de Cabal", "Departamento": "Risaralda", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9702970297029703, "Volumen": 101.0}, {"Ciudad": "Santa Rosa de Cabal", "Departamento": "Risaralda", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6571428571428571, "Volumen": 35.0}, {"Ciudad": "Santa Rosa de Osos", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.10526315789473684, "Volumen": 19.0}, {"Ciudad": "Santander de Quilichao", "Departamento": "Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.30612244897959184, "Volumen": 98.0}, {"Ciudad": "Santo Tomas", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.90625, "Volumen": 64.0}, {"Ciudad": "Sevilla", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8518518518518519, "Volumen": 27.0}, {"Ciudad": "Sevilla", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.0, "Volumen": 1.0}, {"Ciudad": "Sibate", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9024390243902439, "Volumen": 41.0}, {"Ciudad": "Sibate", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8076923076923077, "Volumen": 26.0}, {"Ciudad": "Sincelejo", "Departamento": "Sucre", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7661691542288557, "Volumen": 603.0}, {"Ciudad": "Soacha", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9123505976095617, "Volumen": 1506.0}, {"Ciudad": "Soacha", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7307692307692307, "Volumen": 442.0}, {"Ciudad": "SOCORRO", "Departamento": "SANTANDER", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.45, "Volumen": 40.0}, {"Ciudad": "Sogamoso", "Departamento": "Boyaca", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.8917910447761194, "Volumen": 268.0}, {"Ciudad": "Soledad", "Departamento": "Atlantico", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8959183673469387, "Volumen": 1470.0}, {"Ciudad": "Sopo", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9459459459459459, "Volumen": 37.0}, {"Ciudad": "Suesca", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.75, "Volumen": 20.0}, {"Ciudad": "Tabio", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.7777777777777778, "Volumen": 36.0}, {"Ciudad": "Tenjo", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 1.0, "Volumen": 26.0}, {"Ciudad": "Tierralta", "Departamento": "Cordoba", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7536231884057971, "Volumen": 69.0}, {"Ciudad": "Tocancipa", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.78125, "Volumen": 64.0}, {"Ciudad": "Tocancipa", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7457627118644068, "Volumen": 59.0}, {"Ciudad": "Tulua", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8607594936708861, "Volumen": 316.0}, {"Ciudad": "Tulua", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.5436893203883495, "Volumen": 103.0}, {"Ciudad": "Tunja", "Departamento": "Boyaca", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9124087591240876, "Volumen": 411.0}, {"Ciudad": "Tunja", "Departamento": "Boyaca", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.7710843373493976, "Volumen": 166.0}, {"Ciudad": "Tuquerres", "Departamento": "Nari√±o", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.8260869565217391, "Volumen": 23.0}, {"Ciudad": "Tuquerres", "Departamento": "Nari√±o", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.5, "Volumen": 16.0}, {"Ciudad": "Turbaco", "Departamento": "Bolivar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.6181818181818182, "Volumen": 110.0}, {"Ciudad": "Turbaco", "Departamento": "Bolivar", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.15, "Volumen": 20.0}, {"Ciudad": "Turbo", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.45098039215686275, "Volumen": 51.0}, {"Ciudad": "Turbo", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.13793103448275862, "Volumen": 29.0}, {"Ciudad": "Ubate", "Departamento": "CUNDINAMARCA", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7804878048780488, "Volumen": 41.0}, {"Ciudad": "Ubate", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Uribia", "Departamento": "Guajira", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.0, "Volumen": 40.0}, {"Ciudad": "Valledupar", "Departamento": "Cesar", "Operador": "Lecta", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8936970837253058, "Volumen": 1063.0}, {"Ciudad": "VILLA DE LEIVA", "Departamento": "BOYACA", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 1.0, "Volumen": 27.0}, {"Ciudad": "Villa del Rosario", "Departamento": "Norte de Santander", "Operador": "Logytech Mobile", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.85, "Volumen": 20.0}, {"Ciudad": "Villa del Rosario", "Departamento": "Norte de Santander", "Operador": "Integra", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9411764705882353, "Volumen": 34.0}, {"Ciudad": "Villa del Rosario", "Departamento": "Norte de Santander", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.75, "Volumen": 36.0}, {"Ciudad": "Villamaria", "Departamento": "Caldas", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 1.0, "Volumen": 82.0}, {"Ciudad": "Villamaria", "Departamento": "Caldas", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 1.0, "Volumen": 29.0}, {"Ciudad": "Villavicencio", "Departamento": "Meta", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.8152610441767069, "Volumen": 747.0}, {"Ciudad": "Villeta", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7333333333333333, "Volumen": 30.0}, {"Ciudad": "Viota", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 1.0, "Volumen": 5.0}, {"Ciudad": "Yarumal", "Departamento": "Antioquia", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.045454545454545456, "Volumen": 22.0}, {"Ciudad": "Yarumal", "Departamento": "Antioquia", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": NaN, "Volumen": NaN}, {"Ciudad": "Yumbo", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9411764705882353, "Volumen": 323.0}, {"Ciudad": "Yumbo", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.9230769230769231, "Volumen": 104.0}, {"Ciudad": "Zarzal", "Departamento": "Valle del Cauca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 3.0, "Efectividad": 0.7, "Volumen": 50.0}, {"Ciudad": "Zarzal", "Departamento": "Valle del Cauca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.6896551724137931, "Volumen": 29.0}, {"Ciudad": "Zipaquira", "Departamento": "Cundinamarca", "Operador": "Cali Express", "Cobertura": "S√≠", "Lead Time": 2.0, "Efectividad": 0.9117647058823529, "Volumen": 306.0}, {"Ciudad": "Zipaquira", "Departamento": "Cundinamarca", "Operador": "Esm Logistica", "Cobertura": "S√≠", "Lead Time": 1.0, "Efectividad": 0.6451612903225806, "Volumen": 124.0}];
  const ROWS = (Array.isArray(EMBED_DATA)? EMBED_DATA : [] ).map(r=>({ ciudad: (r.Ciudad||'').toString().trim(), nciudad: normalize(r.Ciudad), departamento: (r.Departamento||'').toString().trim(), ndepto: normalize(r.Departamento), operador: (r.Operador||'').toString().trim(), cobertura: (r.Cobertura==null? true : !(normalize(r.Cobertura)==='NO')), lead: (r['Lead Time']===null || r['Lead Time']===undefined? NaN : Number(r['Lead Time'])), efectividad: (r['Efectividad']===null || r['Efectividad']===undefined? NaN : Number(r['Efectividad'])), volumen: (r['Volumen']===null || r['Volumen']===undefined? NaN : Number(r['Volumen'])) }));
  ROWS.forEach(r=>{ if(!isNaN(r.efectividad) && r.efectividad>0 && r.efectividad<=1) r.efectividad*=100; });
  const KEY = (r)=> r.nciudad+'|'+r.ndepto; const INDEX = new Map(); for(const r of ROWS){ if(!INDEX.has(KEY(r))) INDEX.set(KEY(r), []); INDEX.get(KEY(r)).push(r); }
  const OPTIONS = Array.from(new Map(ROWS.map(r=>[KEY(r), {city:r.ciudad, dep:r.departamento, key:KEY(r)}])).values()).sort((a,b)=> normalize(a.city).localeCompare(normalize(b.city)) || normalize(a.dep).localeCompare(normalize(b.dep)));
  const q = document.getElementById('q'); const suggest = document.getElementById('suggest'); const msg = document.getElementById('msg'); const kpis = document.getElementById('kpis'); const stamp = document.getElementById('stamp'); const kDep = document.getElementById('kDep'); const kOp = document.getElementById('kOp'); const kEnt = document.getElementById('kEnt'); const kVen = document.getElementById('kVen');
  function safeRun(fn){ try{ fn(); }catch(e){ console.error(e); msg.innerHTML='<span style="color:#dc2626">Ocurri√≥ un error. Refresca la p√°gina o verifica la matriz.</span>'; } }
  let activeIdx=-1, currentMatches=[];
  function renderSuggestions(list){ if(!list.length){ suggest.style.display='none'; suggest.innerHTML=''; return; } suggest.innerHTML = list.map((o)=>`<li data-key="${o.key}"><b>${o.city}</b> <span class="hint">‚Äî ${o.dep}</span></li>`).join(''); suggest.style.display='block'; activeIdx=-1; Array.from(suggest.querySelectorAll('li')).forEach((li,idx)=>{ li.addEventListener('click', ()=> safeRun(()=> selectKey(li.getAttribute('data-key')))); li.addEventListener('mousemove', ()=> setActive(idx)); }); }
  function setActive(idx){ Array.from(suggest.children).forEach(li=> li.classList.remove('active')); if(idx>=0 && idx<suggest.children.length){ suggest.children[idx].classList.add('active'); activeIdx=idx; } }
  function findMatches(text){ const n = normalize(text); if(!n) return []; const starts=[], contains=[]; for(const o of OPTIONS){ const nc = normalize(o.city); if(nc.startsWith(n)) starts.push(o); else if(nc.includes(n)) contains.push(o); } return starts.concat(contains).slice(0,50); }
  function selectKey(key){ const list = INDEX.get(key); if(!list || !list.length){ msg.textContent='No hay datos para la selecci√≥n.'; return; } const covered = list.filter(r=> r.cobertura!==false); if(!covered.length){ msg.textContent='Sin cobertura real para esta ciudad.'; kpis.style.display='none'; return; }
    const sorted = [...covered].sort((a,b)=>{ const ae = isNaN(a.efectividad)? -1 : a.efectividad; const be = isNaN(b.efectividad)? -1 : b.efectividad; if (be!==ae) return be-ae; const av = isNaN(a.volumen)? -1 : a.volumen; const bv = isNaN(b.volumen)? -1 : b.volumen; if (bv!==av) return bv-av; const al = isNaN(a.lead)? 9999 : a.lead; const bl = isNaN(b.lead)? 9999 : b.lead; return al-bl; });
    const best = sorted[0]; let baseLead = !isNaN(best.lead)? Math.round(best.lead) : Math.min(...covered.map(r=> isNaN(r.lead)? 9999 : Math.round(r.lead))); if(!isFinite(baseLead) || baseLead===9999) baseLead=0;
    const now = new Date(); const after3pm = now.getHours()>15 || (now.getHours()===15 && now.getMinutes()>0); const holidays = new Set([...colombiaHolidays(now.getFullYear()), ...colombiaHolidays(now.getFullYear()+1)]); const addDays = baseLead + 1 + (after3pm? 1:0); const entrega = addBusinessDays(now, addDays, holidays); const ventana = new Date(entrega); ventana.setDate(ventana.getDate()+2);
    kDep.textContent = best.departamento || '‚Äî'; kOp.textContent = best.operador || '‚Äî'; kEnt.textContent = fmt(entrega); kVen.textContent = fmt(ventana); kpis.style.display='grid'; suggest.style.display='none'; stamp.textContent = '‚è±Ô∏è Consulta: '+ nowStamp(); msg.textContent=''; }
  let t=null; function debounce(f,ms){ return function(...a){ clearTimeout(t); t=setTimeout(()=>f.apply(this,a), ms); } }
  const onType = debounce(()=> safeRun(()=>{ const text=q.value; const n=normalize(text); if(!n){ suggest.style.display='none'; kpis.style.display='none'; msg.textContent=''; return; } if(ROWS.length===0){ msg.innerHTML='<span style="color:#dc2626">No hay datos cargados.</span>'; return; } currentMatches = findMatches(text); renderSuggestions(currentMatches); const exacts = currentMatches.filter(o=> normalize(o.city)===n); if(exacts.length===1){ selectKey(exacts[0].key); return; } if(currentMatches.length===1 && n.length>=3){ selectKey(currentMatches[0].key); return; } msg.textContent = currentMatches.length? 'Selecciona una opci√≥n o contin√∫a escribiendo‚Ä¶' : 'Sin coincidencias.'; }), 120);
  q.addEventListener('input', onType);
  q.addEventListener('keydown', (e)=>{ if(suggest.style.display==='none') return; if(e.key==='ArrowDown'){ e.preventDefault(); setActive(Math.min(activeIdx+1, suggest.children.length-1)); } if(e.key==='ArrowUp'){ e.preventDefault(); setActive(Math.max(activeIdx-1, 0)); } if(e.key==='Enter'){ e.preventDefault(); if(activeIdx>=0){ const li=suggest.children[activeIdx]; safeRun(()=> selectKey(li.getAttribute('data-key'))); } else if(currentMatches.length===1){ safeRun(()=> selectKey(currentMatches[0].key)); } } if(e.key==='Escape'){ suggest.style.display='none'; } });
  stamp.textContent = '‚è±Ô∏è Consulta: '+ nowStamp();
  msg.textContent = 'Escribe la ciudad. Calculamos autom√°ticamente al encontrar una coincidencia.';

</script>
</body>
</html>
